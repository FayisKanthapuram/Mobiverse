<div class="page-header">
  <div class="page-title-group">
    <h2>Brands Management</h2>
    <span>Manage all mobile brands available on Mobiverse.</span>
  </div>
  <button type="button" class="btn-primary-admin" id="open-add-modal-btn">
    <i class="bi bi-plus-lg"></i>
    Add Brand
  </button>
</div>

<div class="filter-bar">
  <!-- ğŸ” Search Input -->
  <div class="search-wrapper">
    <i class="bi bi-search"></i>
    <input type="text" id="brand-search-input" placeholder="Search by brand name..." value="<%= typeof query.search !== 'undefined' ? query.search : '' %>" onkeyup="debounceSearch()" />
    <% if (typeof query.search !== 'undefined' && query.search.trim() !== '') { %>
    <button type="button" class="btn-clear" id="clear-search" onclick="clearSearch()">Clear</button>
    <% } %>
  </div>

  <!-- ğŸ”½ Filter Dropdown (Normal Select) -->
  <div class="filter-select-wrapper">
    <select id="brand-filter-select" name="filter" onchange="applyFilter()">
      <option value="All" <%= !query.filter? 'selected' : '' %>>All</option>
      <option value="listed" <%= query.filter === 'listed' ? 'selected' : '' %>>Listed</option>
      <option value="unlisted" <%= query.filter === 'unlisted' ? 'selected' : '' %>>Unlisted</option>
    </select>
  </div>
</div>

<div class="table-container">
  <table>
    <thead>
      <tr>
        <th>Brand Logo</th>
        <th>Brand Name</th>
        <th>Product Count</th>
        <th>Status</th>
        <th>Actions</th>
      </tr>
    </thead>
    <tbody>
      <% if (brands && brands.length> 0) { %> <% brands.forEach(brand=> { %>
      <tr>
        <td>
          <div class="brand-logo-cell">
            <img src="<%= brand.logo %>" alt="<%= brand.brandName %>" />
          </div>
        </td>
        <td><strong> <%= brand.brandName %> </strong></td>
        <td><%= brand.productCount %></td>
        <td>
          <% if (brand.isListed) { %>
          <span class="status-badge status-listed" data-brand-status data-brand-id="<%= brand._id %>">
            Listed
          </span>
          <% } else { %>
          <span class="status-badge status-unlisted" data-brand-status data-brand-id="<%= brand._id %>">
            Unlisted
          </span>
          <% } %>
        </td>
        <td>
          <div class="action-buttons">
            <button type="button" class="btn-icon-edit open-edit-modal-btn" data-brand-id="<%= brand._id %>">
              <i class="bi bi-pencil-fill"></i>
            </button>
            <% if (brand.isListed) { %>
            <a href="" class="btn-action btn-unlist" data-brand-id="<%= brand._id %>" data-brand-islisted="<%= brand.isListed %>">
              Unlist
            </a>
            <% } else { %>
            <a href="" class="btn-action btn-list" data-brand-id="<%= brand._id %>" data-brand-islisted="<%= brand.isListed %>">
              List
            </a>
            <% } %>
          </div>
        </td>
      </tr>
      <% }) %> <% } else { %>
      <tr>
        <td colspan="5" style="text-align: center; color: #6c757d; padding: 3rem">
          No brands found.
        </td>
      </tr>
      <% } %>
    </tbody>
  </table>
</div>

<%- include('../partials/admin/pagination') %>

<div class="modal-overlay-admin" id="modal-overlay"></div>

<%- include('../partials/admin/brands/addNewBrandModal') %>
<%- include('../partials/admin/brands/editBrandModal') %>
