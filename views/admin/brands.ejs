<!-- Page Header -->
<div class="flex flex-col md:flex-row justify-between items-start md:items-center mb-6 gap-4">
  <div>
    <h2 class="m-0 mb-1 text-2xl font-semibold text-gray-900">Brands Management</h2>
    <span class="text-sm text-gray-500">Manage all mobile brands available on Mobiverse.</span>
  </div>
  <button type="button" 
          class="flex items-center gap-2 px-5 py-3 bg-blue-600 text-white border-none rounded-lg font-semibold text-sm cursor-pointer transition-colors hover:bg-blue-700" 
          id="open-add-modal-btn">
    <i class="bi bi-plus-lg"></i>
    Add Brand
  </button>
</div>

<!-- Filter Bar -->
<div class="flex flex-col md:flex-row justify-between items-stretch md:items-center p-5 bg-white rounded-lg border border-gray-200 mb-6 gap-4">
  <!-- Search Input -->
  <div class="relative w-full md:max-w-md flex items-center gap-2">
    <i class="bi bi-search absolute left-4 text-gray-400"></i>
    <input type="text" 
           id="brand-search-input" 
           placeholder="Search by brand name..." 
           value="<%= typeof query.search !== 'undefined' ? query.search : '' %>" 
           onkeyup="debounceSearch()" 
           class="flex-1 px-4 py-3 pl-10 border border-gray-300 rounded-md text-sm outline-none transition-all focus:border-blue-600 focus:ring-2 focus:ring-blue-100" />
    
    <% if (typeof query.search !== 'undefined' && query.search.trim() !== '') { %>
    <button type="button" 
            class="px-4 py-2 bg-gradient-to-br from-blue-50 to-blue-100 text-blue-600 border border-blue-200 rounded-lg font-semibold text-sm tracking-wide cursor-pointer transition-all hover:from-blue-600 hover:to-blue-700 hover:text-white hover:border-blue-600 hover:shadow-lg hover:-translate-y-0.5 active:translate-y-0" 
            id="clear-search" 
            onclick="clearSearch()">
      Clear
    </button>
    <% } %>
  </div>

  <!-- Filter Dropdown -->
  <div class="relative">
    <select id="brand-filter-select" 
            name="filter" 
            onchange="applyFilter()" 
            class="appearance-none bg-white border border-gray-300 rounded-md px-4 py-3 pr-10 text-sm text-gray-700 cursor-pointer font-medium transition-all hover:border-gray-400 focus:border-blue-600 focus:ring-2 focus:ring-blue-100 outline-none">
      <option value="All" <%= !query.filter ? 'selected' : '' %>>All</option>
      <option value="listed" <%= query.filter === 'listed' ? 'selected' : '' %>>Listed</option>
      <option value="unlisted" <%= query.filter === 'unlisted' ? 'selected' : '' %>>Unlisted</option>
    </select>
    <span class="absolute right-4 top-1/2 -translate-y-1/2 text-xs text-gray-500 pointer-events-none">â–¼</span>
  </div>
</div>

<!-- Table Container -->
<div class="bg-white border border-gray-200 rounded-lg overflow-x-auto">
  <table class="w-full border-collapse min-w-[800px]">
    <thead>
      <tr>
        <th class="px-5 py-4 text-left border-b border-gray-200 text-xs font-semibold text-gray-500 uppercase tracking-wider">Brand Logo</th>
        <th class="px-5 py-4 text-left border-b border-gray-200 text-xs font-semibold text-gray-500 uppercase tracking-wider">Brand Name</th>
        <th class="px-5 py-4 text-left border-b border-gray-200 text-xs font-semibold text-gray-500 uppercase tracking-wider">Product Count</th>
        <th class="px-5 py-4 text-left border-b border-gray-200 text-xs font-semibold text-gray-500 uppercase tracking-wider">Status</th>
        <th class="px-5 py-4 text-left border-b border-gray-200 text-xs font-semibold text-gray-500 uppercase tracking-wider">Actions</th>
      </tr>
    </thead>
    <tbody>
      <% if (brands && brands.length > 0) { %>
      <% brands.forEach(brand => { %>
      <tr class="hover:bg-gray-50 transition-colors">
        <td class="px-5 py-4 border-b border-gray-200 align-middle">
          <div>
            <img src="<%= brand.logo %>" 
                 alt="<%= brand.brandName %>" 
                 class="w-10 h-10 rounded-md object-contain bg-gray-50 border border-gray-100" />
          </div>
        </td>
        <td class="px-5 py-4 border-b border-gray-200 align-middle">
          <strong class="text-gray-900"><%= brand.brandName %></strong>
        </td>
        <td class="px-5 py-4 border-b border-gray-200 align-middle text-gray-700">
          <%= brand.productCount %>
        </td>
        <td class="px-5 py-4 border-b border-gray-200 align-middle">
          <% if (brand.isListed) { %>
          <span class="inline-flex items-center gap-1.5 px-2.5 py-1.5 rounded-2xl text-xs font-semibold bg-green-100 text-green-700" 
                data-brand-status 
                data-brand-id="<%= brand._id %>">
            Listed
          </span>
          <% } else { %>
          <span class="inline-flex items-center gap-1.5 px-2.5 py-1.5 rounded-2xl text-xs font-semibold bg-red-100 text-red-700" 
                data-brand-status 
                data-brand-id="<%= brand._id %>">
            Unlisted
          </span>
          <% } %>
        </td>
        <td class="px-5 py-4 border-b border-gray-200 align-middle">
          <div class="flex items-center gap-3">
            <button type="button" 
                    class="text-lg text-gray-700 bg-transparent border-none cursor-pointer p-1 transition-colors hover:text-blue-600 open-edit-modal-btn" 
                    data-brand-id="<%= brand._id %>">
              <i class="bi bi-pencil-fill"></i>
            </button>
            
            <% if (brand.isListed) { %>
            <a href="" 
               class="px-3 py-2 border rounded-md font-semibold text-xs no-underline transition-all text-red-600 border-red-300 bg-white hover:bg-red-600 hover:text-white btn-action btn-unlist" 
               data-brand-id="<%= brand._id %>" 
               data-brand-islisted="<%= brand.isListed %>">
              Unlist
            </a>
            <% } else { %>
            <a href="" 
               class="px-3 py-2 border rounded-md font-semibold text-xs no-underline transition-all text-green-600 border-green-300 bg-white hover:bg-green-600 hover:text-white btn-action btn-list" 
               data-brand-id="<%= brand._id %>" 
               data-brand-islisted="<%= brand.isListed %>">
              List
            </a>
            <% } %>
          </div>
        </td>
      </tr>
      <% }) %>
      <% } else { %>
      <tr>
        <td colspan="5" class="text-center text-gray-500 py-12">
          No brands found.
        </td>
      </tr>
      <% } %>
    </tbody>
  </table>
</div>

<%- include('../partials/admin/brands/pagination') %>

<!-- Modal Overlay -->
<div class="modal-overlay-admin fixed top-0 left-0 w-full h-full bg-black bg-opacity-60 backdrop-blur-sm z-[1000] opacity-0 invisible transition-all duration-300" 
     id="modal-overlay"></div>

<%- include('../partials/admin/brands/addNewBrandModal') %>
<%- include('../partials/admin/brands/editBrandModal') %>