<% /* views/partials/_productCard.ejs */ %>

<div class="swiper-slide h-auto">
  <a href="/product/<%= product?.variants?._id %>" class="block group h-full">
    <div class="bg-white rounded-xl shadow-md overflow-hidden h-full transition-all duration-300 hover:shadow-2xl relative">
      <div class="relative bg-gray-100 p-4 overflow-hidden">
        <img src="<%= product?.variants?.images[0] %>" alt="<%= product.name %>" class="h-48 w-full object-contain transition-transform duration-300 group-hover:scale-110" />

        <button type="button" class="absolute top-3 right-3 bg-white w-10 h-10 rounded-full flex items-center justify-center text-gray-500 hover:text-red-500 shadow-sm transition-colors z-20" onclick="event.stopPropagation();event.preventDefault();addToWishlist('<%= product?.variants?._id %>')">
          <i class="bi bi-heart text-xl"></i>
        </button>
      </div>

      <div class="p-5 relative">
        <h3 class="text-lg font-semibold text-gray-800 truncate">
          <%= product.name %>
        </h3>

        <div class="flex items-center space-x-1 mb-2" aria-label="Rating: <%= product?.variants?.rating?.toFixed(1) || '0.0' %> out of 5 stars">
          <% const fullStars = Math.floor(product?.variants?.rating || 0); const
          halfStar = (product?.variants?.rating % 1) >= 0.5; const emptyStars =
          5 - fullStars - (halfStar ? 1 : 0); %> <% for(let i = 0; i <
          fullStars; i++) { %>
          <i class="bi bi-star-fill text-yellow-400" aria-hidden="true"></i>
          <% } %> <% if(halfStar) { %>
          <i class="bi bi-star-half text-yellow-400" aria-hidden="true"></i>
          <% } %> <% for(let i = 0; i < emptyStars; i++) { %>
          <i class="bi bi-star text-yellow-400" aria-hidden="true"></i>
          <% } %>
          <span class="text-sm text-gray-500 ml-1">(<%= product?.variants?.rating?.toFixed(1) || '0.0' %>)</span>
        </div>

        <div class="mt-2 mb-4">
          <p class="text-2xl font-bold text-gray-900 flex items-center gap-2">
            ₹<%= product?.variants?.salePrice?.toLocaleString('en-IN') %> <% if
            (product?.variants?.regularPrice) { %>
            <del class="text-gray-400 text-lg line-through">
              ₹<%= product?.variants?.regularPrice?.toLocaleString('en-IN') %>
            </del>
            <% } %>
          </p>
        </div>

        <button type="button" class="absolute left-0 bottom-0 w-full bg-blue-600 text-white font-semibold py-3 text-center transition-transform duration-300 translate-y-full group-hover:translate-y-0" onclick="event.preventDefault(); addToCart('<%= product?.variants?._id %>')">
          Add to Cart
        </button>
      </div>
    </div>
  </a>
</div>