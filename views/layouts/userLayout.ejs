<!DOCTYPE html>
<html lang="en" class="scroll-smooth">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title><%= pageTitle %> - Mobiverse</title>

  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css">
  <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/toastify-js/src/toastify.min.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.6.1/cropper.min.css">
  <script src="https://checkout.razorpay.com/v1/checkout.js"></script>

  <!-- tailwind -->
  <link rel="stylesheet" href="/css/tailwind/style.css">
  <link rel="stylesheet" href="/css/tailwind/input.css">

  <% if (typeof pageCss !== 'undefined' && pageCss) { %>
  <link rel="stylesheet" href="/css/user/<%= pageCss %>.css">
  <% } %>
</head>

<body class="bg-gray-50 text-gray-900 antialiased">

  <% if (user) { %>
  <%- include('../partials/user/navbarLogged', { query: typeof query !== 'undefined' ? query : {} }) %>
  <% } else { %>
  <%- include('../partials/user/navbarGuest', { query: typeof query !== 'undefined' ? query : {} }) %>
  <% } %>

  <%- body %>

  <%- include('../partials/user/footer') %>

  <script src="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.js"></script>

  <script type="text/javascript" src="https://cdn.jsdelivr.net/npm/toastify-js"></script>
  <script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>

  <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.6.1/cropper.min.js"></script>

  <script src="/js/user/user.js"></script>
  <script>
    // Axios / client-side toasts
    const successMsg = sessionStorage.getItem("toastSuccess");
    const errorMsg = sessionStorage.getItem("toastError");

    if (successMsg) {
      showToast(successMsg, "success");
      sessionStorage.removeItem("toastSuccess");
    }

    if (errorMsg) {
      showToast(errorMsg, "error");
      sessionStorage.removeItem("toastError");
    }


    const toast = <%- JSON.stringify(toast) %>;

    // Backend redirect toast
    <% if (toast) { %>
      showAlert("<%= toast.message %>", "<%= toast.type %>");
    <% } %>

    function showAlert(message, type = "success") {
      Swal.fire({
        icon: type, // success | error | warning | info
        title: message,
        allowOutsideClick: false,
        allowEscapeKey: false,
        confirmButtonText: "OK",
        heightAuto: false,
      });
    }


    function showToast(message, type = "success") {
      const colors = {
        success: "linear-gradient(to right, #22c55e, #16a34a)",
        error: "linear-gradient(to right, #ef4444, #dc2626)",
        info: "linear-gradient(to right, #3b82f6, #2563eb)",
        warning: "linear-gradient(to right, #facc15, #eab308)",
      };

      Toastify({
        text: message,
        duration: 3000,
        close: true,
        gravity: "bottom",
        position: "right",
        stopOnFocus: true,
        style: {
          background: colors[type] || colors.success,
        },
      }).showToast();
    }
  </script>



  <% if (typeof pageJs !== 'undefined' && pageJs) { %>
  <script src="/js/user/<%= pageJs %>.js"></script>
  <% } %>

</body>

</html>